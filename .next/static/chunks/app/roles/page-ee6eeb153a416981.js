(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1550],{6940:function(e,s,a){Promise.resolve().then(a.bind(a,3690))},3690:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return Z}});var t=a(7437),r=a(3107),n=a(146),l=a(7907),i=a(2265),o=a(8009),d=a(7948),c=a(4590),u=a(2498),m=a(8489),h=a(1352),x=a(6795),p=a(8033),f=a(4845),g=a(7742),b=a(4353);let j=(0,g.j)("peer relative  inline-flex items-center  [&_.content-box>svg]:h-4  [&_.content-box>svg]:w-4  [&_.content-box]:text-primary-foreground [&_.content-box]:text-[10px] justify-start group  flex-shrink-0  cursor-pointer rounded-full  transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=unchecked]:bg-default-300",{variants:{color:{primary:"data-[state=checked]:bg-primary ",secondary:"data-[state=checked]:bg-secondary ",info:"data-[state=checked]:bg-info ",warning:"data-[state=checked]:bg-warning ",success:"data-[state=checked]:bg-success ",destructive:"data-[state=checked]:bg-destructive ",dark:"data-[state=checked]:bg-foreground "},size:{sm:"h-4 w-[30px]  [&_.content-box]:text-[7px] [&_.content-box>svg]:h-2.5  [&_.content-box>svg]:w-2.5 ",md:"h-5 w-[38px] ",lg:"h-6 w-[42px]"}},defaultVariants:{color:"primary",size:"md"}}),y=i.forwardRef((e,s)=>{let{className:a,size:r,color:n,startContent:l,endContent:i,thumbClass:o,thumbIcon:d,...c}=e;return(0,t.jsxs)(f.fC,{className:(0,b.cn)(j({size:r,color:n}),a),...c,ref:s,children:[l&&(0,t.jsx)("span",{className:"absolute left-1  content-box   text-medium opacity-0 scale-50 transition-transform-opacity group-data-[state=checked]:scale-100 group-data-[state=checked]:opacity-100 ",children:l}),(0,t.jsx)(f.bU,{className:(0,b.cn)("pointer-events-none z-10 origin-right  h-4 w-4 rounded-full bg-background  shadow-lg ring-0 transition-all  flex items-center justify-center   ltr:data-[state=checked]:ml-5 rtl:data-[state=checked]:mr-5 rtl:data-[state=unchecked]:mr-0.5 ",o,{"h-3 w-3 data-[state=checked]:ml-4 ":"sm"===r,"h-4 w-4 ":"md"===r,"h-5 w-5 ":"lg"===r}),children:d||null}),i&&(0,t.jsx)("span",{className:"z-0  content-box   absolute right-1  text-medium opacity-100 transition-transform-opacity group-data-[state=checked]:translate-x-3 group-data-[state=checked]:opacity-0  ",children:i})]})});y.displayName=f.fC.displayName;var v=a(4273),w=e=>{let{icon:s,fetchAllRoles:a,id:d}=e,[m,f]=(0,i.useState)({rolename:"",permissions:{}}),[g,b]=(0,i.useState)([]),[j,w]=(0,i.useState)([]),N=(0,l.useRouter)();(0,i.useEffect)(()=>{(async()=>{await k(d),await C()})()},[d]);let k=async e=>{try{let s=await r.Z.get("".concat("https://api.bharatniveshyatra.com","/api/roles/").concat(e),{headers:{"x-auth-token":n.Z.get("authToken")}});f(s.data)}catch(e){console.error("Error fetching role:",e)}},C=async()=>{try{let e=await r.Z.get("".concat("https://api.bharatniveshyatra.com","/api/permissions"),{headers:{"x-auth-token":n.Z.get("authToken")}});if(200===e.status){let s=e.data.permissions;b(s),w([...new Set(Object.keys(s).map(e=>e.split(":")[0]))])}}catch(e){console.error("Error fetching permissions:",e)}},Z=(e,s)=>{f(a=>{let t;let r=a.permissions[e]||[];return t=r.some(e=>e.name.includes(s))?r.filter(e=>!e.name.includes(s)):[...r,{name:"".concat(e,":").concat(s)}],{...a,permissions:{...a.permissions,[e]:t}}})},R=async()=>{try{await r.Z.put("".concat("https://api.bharatniveshyatra.com","/api/roles/").concat(d),m,{headers:{"x-auth-token":n.Z.get("authToken")}}),o.ZP.success("Role updated successfully"),a()}catch(e){(0,v.Z)(e,N)}};return(0,t.jsxs)(h.Vq,{children:[(0,t.jsx)(h.hg,{onClick:()=>{k(d),C()},asChild:!0,children:s}),(0,t.jsxs)(h.cZ,{size:"5xl",className:"p-0",children:[(0,t.jsx)(h.fK,{className:"p-6 pb-2",children:(0,t.jsx)(h.$N,{className:"text-base font-medium",children:"Update Roles"})}),(0,t.jsxs)("div",{className:"max-h-full px-6",children:[(0,t.jsx)("div",{className:"sm:grid sm:grid-cols-1 sm:gap-5 space-y-4 sm:space-y-0",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(p._,{children:"Role Name"}),(0,t.jsx)(x.I,{value:(null==m?void 0:m.rolename)||"",onChange:e=>f({...m,rolename:e.target.value}),type:"text",placeholder:"Enter role name"})]})}),(0,t.jsxs)(u.iA,{children:[(0,t.jsx)(u.xD,{children:(0,t.jsxs)(u.SC,{children:[(0,t.jsx)(u.ss,{children:"Permissions"}),(0,t.jsx)(u.ss,{children:"Read"}),(0,t.jsx)(u.ss,{children:"Write"}),(0,t.jsx)(u.ss,{children:"Update"}),(0,t.jsx)(u.ss,{children:"Delete"})]})}),(0,t.jsx)(u.RM,{children:j.map(e=>(0,t.jsxs)(u.SC,{children:[(0,t.jsx)(u.pj,{children:e}),["read","write","update","delete"].map(s=>{var a;let r=!g[e].some(a=>a.name.startsWith(e)&&a.name.endsWith(s)),n=null===(a=m.permissions[e])||void 0===a?void 0:a.some(a=>a.name==="".concat(e,":").concat(s));return(0,t.jsx)(u.pj,{children:(0,t.jsx)(y,{checked:n,onClick:()=>Z(e,s),disabled:r})},s)})]},e))})]})]}),(0,t.jsxs)("div",{className:"p-6 pt-4 flex justify-between",children:[(0,t.jsx)(h.GG,{asChild:!0,children:(0,t.jsx)(c.z,{type:"button",color:"warning",children:"Close"})}),(0,t.jsx)(c.z,{type:"submit",onClick:R,children:"Submit"})]})]})]})},N=e=>{let{fetchAllRoles:s,roles:a,fetchAllPermissions:h}=e,[x,p]=(0,i.useState)([]),f=(0,l.useRouter)(),g=e=>{let s=[...x];x.includes(e)?s.splice(x.indexOf(e),1):s.push(e),p(s)},b=async e=>{try{let a=await r.Z.delete("".concat("https://api.bharatniveshyatra.com","/api/roles/").concat(e),{headers:{"x-auth-token":n.Z.get("authToken")}});200===a.status&&(o.ZP.success("Role deleted successfully"),s())}catch(e){409===e.response.status&&o.ZP.error("User exists in this role!"),(0,v.Z)(e,f)}};return(0,t.jsx)(t.Fragment,{children:a&&(0,t.jsxs)(u.iA,{children:[(0,t.jsx)(u.xD,{children:(0,t.jsxs)(u.SC,{children:[(0,t.jsx)(u.ss,{children:(0,t.jsx)(m.X,{checked:x.length===a.length||"indeterminate",onCheckedChange:()=>{(null==x?void 0:x.length)===(null==a?void 0:a.length)?p([]):p(a.map(e=>e.id))}})}),(0,t.jsx)(u.ss,{className:" font-semibold",children:"Role Name"}),(0,t.jsx)(u.ss,{children:"Permissions"}),(0,t.jsx)(u.ss,{children:"Action"})]})}),(0,t.jsx)(u.RM,{children:a.map(e=>{var a;return(0,t.jsx)(t.Fragment,{children:e.deleted_at?null:(0,t.jsxs)(u.SC,{className:"hover:bg-muted","data-state":x.includes(e._id)&&"selected",children:[(0,t.jsx)(u.pj,{children:(0,t.jsx)(m.X,{checked:x.includes(e._id),onCheckedChange:()=>g(e._id)})}),(0,t.jsx)(u.pj,{children:e.name.charAt(0).toUpperCase()+e.name.slice(1)}),(0,t.jsx)(u.pj,{children:e.permissions.map(e=>e.name).join(", ")}),(0,t.jsx)(u.pj,{className:"flex justify-end",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(null===(a=localStorage.getItem("userPermissions"))||void 0===a?void 0:a.includes("roles:update"))&&(0,t.jsx)(w,{icon:(0,t.jsx)(c.z,{size:"icon",variant:"outline",className:"h-7 w-7",color:"secondary",children:(0,t.jsx)(d.JO,{icon:"heroicons:pencil",className:" h-4 w-4"})}),fetchAllRoles:s,id:e._id,fetchAllPermissions:h}),localStorage.getItem("userPermissions").includes("roles:delete")&&(0,t.jsx)(c.z,{onClick:()=>b(e._id),size:"icon",variant:"outline",className:" h-7 w-7",color:"secondary",children:(0,t.jsx)(d.JO,{icon:"heroicons:trash",className:" h-4 w-4"})})]})})]},e._id)})})})]})})},k=a(94),C=e=>{let{fetchAllRoles:s,fetchAllPermissions:a}=e,[d,m]=(0,i.useState)({name:"",permissions:{}}),[f,g]=(0,i.useState)([]),[b,j]=(0,i.useState)([]),w=(0,l.useRouter)();(0,i.useEffect)(()=>{(async()=>{let e=await a();g(e),j([...new Set(Object.keys(e).map(e=>e.split(":")[0]))])})()},[a]);let N=(e,s)=>f[e].some(a=>a.name==="".concat(e,":").concat(s)),C=(e,s)=>{var a;return(null===(a=d.permissions[e])||void 0===a?void 0:a.includes("".concat(e,":").concat(s)))||!1},Z=(e,s)=>{m(a=>{let t;let r=a.permissions[e]||[];return t=r.includes("".concat(e,":").concat(s))?r.filter(a=>a!=="".concat(e,":").concat(s)):[...r,"".concat(e,":").concat(s)],{...a,permissions:{...a.permissions,[e]:t}}})},R=async()=>{if(!d.name){o.ZP.error("Please enter a role name!");return}if(0===Object.keys(d.permissions).length){o.ZP.error("Please select at least one permission!");return}try{await r.Z.post("".concat("https://api.bharatniveshyatra.com","/api/roles"),d,{headers:{"x-auth-token":n.Z.get("authToken")}}),o.ZP.success("Role added successfully!"),s(),m({name:"",permissions:{}})}catch(s){var e,a,t;if((null==s?void 0:null===(e=s.response)||void 0===e?void 0:e.status)===409){o.ZP.error(null==s?void 0:null===(t=s.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.msg);return}m({name:"",permissions:{}}),(0,v.Z)(s,w)}};return(0,t.jsxs)(h.Vq,{children:[(0,t.jsx)(h.hg,{asChild:!0,children:(0,t.jsxs)(c.z,{children:[(0,t.jsx)(k.Z,{}),"Add Role"]})}),(0,t.jsxs)(h.cZ,{size:"5xl",className:"p-0",children:[(0,t.jsx)(h.fK,{className:"p-6 pb-2",children:(0,t.jsx)(h.$N,{className:"text-base font-medium",children:"Add New Role"})}),(0,t.jsxs)("div",{className:"max-h-full px-6",children:[(0,t.jsx)("div",{className:"sm:grid sm:grid-cols-1 sm:gap-5 space-y-4 sm:space-y-0",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(p._,{children:"Role Name"}),(0,t.jsx)(x.I,{value:(null==d?void 0:d.name)||"",onChange:e=>m({...d,name:e.target.value}),type:"text",placeholder:"Enter role name"})]})}),(0,t.jsxs)(u.iA,{className:"text-left",children:[(0,t.jsx)(u.xD,{children:(0,t.jsxs)(u.SC,{children:[(0,t.jsx)(u.ss,{children:"Permissions"}),(0,t.jsx)(u.ss,{children:"Read"}),(0,t.jsx)(u.ss,{children:"Write"}),(0,t.jsx)(u.ss,{children:"Update"}),(0,t.jsx)(u.ss,{children:"Delete"})]})}),(0,t.jsx)(u.RM,{children:b.map(e=>(0,t.jsxs)(u.SC,{children:[(0,t.jsx)(u.pj,{children:e}),["read","write","update","delete"].map(s=>{let a=!N(e,s),r=C(e,s);return(0,t.jsx)(u.pj,{className:"last:text-left",children:(0,t.jsx)(y,{checked:r,onClick:()=>Z(e,s),disabled:a})},s)})]},e))})]})]}),(0,t.jsxs)("div",{className:"p-6 pt-4 flex justify-between",children:[(0,t.jsx)(h.GG,{asChild:!0,children:(0,t.jsx)(c.z,{type:"button",color:"warning",children:"Close"})}),(0,t.jsx)(c.z,{type:"submit",onClick:R,children:"Submit"})]})]})]})},Z=e=>{var s;let{trans:a}=e,[o,d]=(0,i.useState)([]),c=(0,l.useRouter)(),u=async()=>{try{let e=await r.Z.get("".concat("https://api.bharatniveshyatra.com","/api/permissions"),{headers:{"x-auth-token":n.Z.get("authToken")}});if(200===e.status)return e.data.permissions}catch(e){console.error(e)}},m=async()=>{try{let e=await r.Z.get("".concat("https://api.bharatniveshyatra.com","/api/roles"),{headers:{"x-auth-token":n.Z.get("authToken")}});200===e.status&&d(e.data)}catch(e){(0,v.Z)(e,c)}};return(0,i.useEffect)(()=>{m()},[]),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center flex-wrap justify-between mt-4 gap-4",children:[(0,t.jsx)("div",{className:"text-2xl font-medium text-default-800 ",children:"Roles"}),(null===(s=localStorage.getItem("userPermissions"))||void 0===s?void 0:s.includes("roles:write"))&&(0,t.jsx)(C,{fetchAllRoles:m,fetchAllPermissions:u})]}),(0,t.jsx)(N,{fetchAllRoles:m,trans:a,roles:o,fetchAllPermissions:u})]})}},1352:function(e,s,a){"use strict";a.d(s,{$N:function(){return g},GG:function(){return h},Vq:function(){return c},cZ:function(){return p},fK:function(){return f},hg:function(){return u}});var t=a(7437),r=a(2265),n=a(2936),l=a(2235),i=a(7742),o=a(4353);let d=(0,i.j)(" fixed  left-1/2 top-1/2 z-[99] grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2  bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg grid gap-4",{variants:{size:{xs:"md:max-w-[332px] w-[90%]",sm:"md:max-w-[384px] w-[90%]",md:"md:max-w-[444px] w-[90%]",lg:"md:max-w-[536px] w-[90%]",xl:"md:max-w-[628px] w-[90%]","2xl":"md:max-w-[720px] w-[90%]","3xl":"md:max-w-[812px] w-[90%]","4xl":"md:max-w-[904px] w-[90%]","5xl":"md:max-w-[996px] w-[90%]",full:"h-screen max-w-full"}},defaultVariants:{size:"md"}}),c=n.fC,u=n.xz,m=n.h_,h=n.x8,x=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(n.aV,{ref:s,className:(0,o.cn)("fixed  z-[99]  inset-0  bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 ",a),...r})});x.displayName=n.aV.displayName;let p=r.forwardRef((e,s)=>{let{className:a,children:r,size:i,overlayClass:c,overlayScroll:u=!1,hiddenCloseIcon:h=!1,...p}=e;return(0,t.jsxs)(m,{children:[(0,t.jsx)(x,{className:c}),(0,t.jsxs)(n.VY,{ref:s,className:(0,o.cn)(d({size:i}),a),...p,children:[r,!h&&(0,t.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(l.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});p.displayName=n.VY.displayName;let f=e=>{let{className:s,children:a,...r}=e;return(0,t.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left  relative",s),...r,children:a})};f.displayName="DialogHeader";let g=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(n.Dx,{ref:s,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});g.displayName=n.Dx.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(n.dk,{ref:s,className:(0,o.cn)("text-sm text-muted-foreground",a),...r})}).displayName=n.dk.displayName},6795:function(e,s,a){"use strict";a.d(s,{I:function(){return o}});var t=a(7437),r=a(2265),n=a(7742),l=a(4353);let i=(0,n.j)(" w-full   bg-background  border-default-300 dark:border-700  px-3 h-9   text-sm  file:border-0 file:bg-transparent file:text-sm file:font-medium  read-only:leading-9 read-only:bg-background  disabled:cursor-not-allowed disabled:opacity-50  transition duration-300 ",{variants:{color:{default:"border-default-300 text-default-500 focus:outline-none focus:border-primary disabled:bg-default-200  placeholder:text-primary-500",primary:"border-primary text-primary focus:outline-none focus:border-primary-700 disabled:bg-primary/30 disabled:placeholder:text-primary  placeholder:text-primary",info:"border-info/50 text-info focus:outline-none focus:border-info-700 disabled:bg-info/30 disabled:placeholder:text-info  placeholder:text-info/70",warning:"border-warning/50 text-warning focus:outline-none focus:border-warning-700 disabled:bg-warning/30 disabled:placeholder:text-info  placeholder:text-warning/70",success:"border-success/50 text-success focus:outline-none focus:border-success-700 disabled:bg-success/30 disabled:placeholder:text-info  placeholder:text-success/70",destructive:"border-destructive/50 text-destructive focus:outline-none focus:border-destructive-700 disabled:bg-destructive/30 disabled:placeholder:text-destructive  placeholder:text-destructive/70"},variant:{flat:"bg-default-100 read-only:bg-default-100",underline:"border-b",bordered:"border  ",faded:"border border-default-300 bg-default-100",ghost:"border-0 focus:border","flat-underline":"bg-default-100 border-b"},shadow:{none:"",sm:"shadow-sm",md:"shadow-md",lg:"shadow-lg",xl:"shadow-xl","2xl":"shadow-2xl"},radius:{none:"rounded-none",sm:"rounded",md:"rounded-lg",lg:"rounded-xl",xl:"rounded-[20px]"},size:{sm:"h-8 text-xs read-only:leading-8",md:"h-9 text-xs read-only:leading-9",lg:"h-10 text-sm read-only:leading-10",xl:"h-12 text-base read-only:leading-[48px]"}},compoundVariants:[{variant:"flat",color:"primary",className:"bg-primary/10 read-only:bg-primary/10"},{variant:"flat",color:"info",className:"bg-info/10 read-only:bg-info/10"},{variant:"flat",color:"warning",className:"bg-warning/10 read-only:bg-warning/10"},{variant:"flat",color:"success",className:"bg-success/10 read-only:bg-success/10"},{variant:"flat",color:"destructive",className:"bg-destructive/10 read-only:bg-destructive/10"},{variant:"faded",color:"primary",className:"bg-primary/10 border-primary/30 read-only:bg-primary/10 border-primary/30"},{variant:"faded",color:"info",className:"bg-info/10 border-info/30"},{variant:"faded",color:"warning",className:"bg-warning/10 border-warning/30"},{variant:"faded",color:"success",className:"bg-success/10 border-success/30"},{variant:"faded",color:"destructive",className:"bg-destructive/10 border-destructive/30"}],defaultVariants:{color:"default",size:"md",variant:"bordered",radius:"md"}}),o=r.forwardRef((e,s)=>{let{className:a,type:r,size:n,color:o,radius:d,variant:c,shadow:u,removeWrapper:m=!1,...h}=e;return m?(0,t.jsx)("input",{type:r,className:(0,l.cn)(i({color:o,size:n,radius:d,variant:c,shadow:u}),a),ref:s,...h}):(0,t.jsx)("div",{className:"flex-1 w-full",children:(0,t.jsx)("input",{type:r,className:(0,l.cn)(i({color:o,size:n,radius:d,variant:c,shadow:u}),a),ref:s,...h})})});o.displayName="Input"}},function(e){e.O(0,[6984,1969,8286,8529,8009,8558,7062,8889,2971,8069,1744],function(){return e(e.s=6940)}),_N_E=e.O()}]);